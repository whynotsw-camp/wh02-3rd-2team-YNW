use cache_db;

drop table if exists cache;

create table cache (
	id INT primary key AUTO_INCREMENT, 
    created_at datetime NOT NULL, # 생성 날짜 - 최신 기준으로 3일 전? 까지만 가져올 예정 
    query TEXT NOT NULL, # 이전에 질의한 질의 해당 
    hashed_docs VARCHAR(100) NOT NULL, # 가져온 문서를 md5 형식으로 해시하여 저장하는 공간 - 최대 3개
    created_answer TEXT NOT NULL # 해당 질의 기반 생성된 이전의 답변 내역
);

""" template :: 
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    'query', -- query
    'hashed_docs', -- hashed_docs
    'answer' -- llm answer invoked
);
"""

-- 10개 정도
-- 1
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), 
    "결제 후 주문 취소가 가능한가요?", -- query
    "b65de77b98474d2b6b46db080add07f0,e4d477a414f3783aa6b9a762d34bf195,fdfce5acb9c600b8f2ffb7ced6f3d719", -- hashed_docs
    "Answer : 네, 고객님.
 결제 후 주문 취소 가능 여부는 상품 배송 여부에 따라 달라집니다.
 배송 전이라면 주문 취소가 가능하지만, 배송이 시작된 경우에는 취소가 어려울 수 있습니다.
 정확한 상담을 위해 주문하신 주문 번호 확인 부탁드립니다.
 주문번호 확인 후, 취소 가능 여부와 절차를 안내해 드리겠습니다.



**조건별 대응 방법**

* **배송 전:** 고객님의 주문번호를 확인하여 주문 취소를 진행해 드립니다.
 취소 완료 후 결제 취소까지는 카드사별로 3~7일(주말 및 공휴일 제외) 정도 소요될 수 있으며, 자세한 내용은 해당 카드사에 문의하시는 것이 좋습니다.


* **배송 중 또는 배송 완료:** 주문 취소는 불가능하며, 배송 완료 후 반품을 접수하셔야 합니다.
 단, 단순 변심으로 인한 반품 시 왕복 배송비가 부과될 수 있다는 점 양해 부탁드립니다.
 반품 절차에 대한 안내를 드리겠습니다.


* **주문 취소 철회 요청:** 이미 주문 취소를 완료하신 경우에는 취소를 철회할 수 없습니다.
 재구매를 부탁드립니다.


* **기타:** 제공된 정보만으로는 답변이 어려운 경우, '문의주신 내용은 확인이 필요하여 지금 답변드리기 어려울 것 같습니다.
 번거로우시겠지만 확인 후에 다시 연락드려도 괜찮을까요?' 라고 답변합니다.

."  -- created_answer
);

-- 2
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '주문 내역을 어떻게 확인하나요?', -- query
    '0aa120541015fd1c61fc09a54cf162d1,1bdb078f44836a398071cbb40f3c9c6b,3ce1b4ff326530a9e3c5f875c5062855', -- hashed_docs
    'Answer : 네, 고객님의 주문 내역 확인을 도와드리겠습니다.
 마이쿠팡에 접속하셔서 주문목록을 확인하시면 됩니다.
 주문목록에서 찾지 못하셨다면, 주문 시 발송된 이메일을 확인하거나, 고객센터(1577-7011)로 연락주시면 친절하게 안내해 드리겠습니다.



**조건별 대응 방법:**

* **주문 내역이 마이쿠팡 주문목록에 있는 경우:** "고객님, 마이쿠팡 > 주문목록에서 주문 내역을 확인하실 수 있습니다.
 해당 상품을 찾으시면 주문 상세 내역을 보실 수 있습니다.
"

* **주문 내역이 마이쿠팡 주문목록에 없고, 이메일도 확인되지 않은 경우:** "죄송합니다만, 고객님의 주문 내역을 확인하는 데 어려움이 있습니다.
 정확한 상담을 위해 주문하신 주문 번호 확인 부탁드립니다.
 주문 번호를 알려주시면 빠르게 확인하여 도와드리겠습니다.
"

* **주문 내역이 마이쿠팡 주문목록에 없지만, 이메일에는 있는 경우:** "고객님, 주문 내역이 이메일에는 있지만 마이쿠팡 주문목록에는 없으시군요.
 혹시 주문 내역을 삭제하신 것은 아닌지 확인 부탁드립니다.
 만약 삭제하셨다면, 이메일을 참고하시거나 고객센터(1577-7011)로 연락주시면 추가적인 안내를 드리겠습니다.
"

* **선물하기 주문인 경우:** "고객님, 선물하기 주문 내역도 마이쿠팡 주문목록에서 확인 가능합니다.
 받는 분의 이름이 표기되어 있으니 확인해 보세요.
"

* **기타 (context 정보 부족):** "문의주신 내용은 확인이 필요하여 지금 답변드리기 어려울 것 같습니다.
 번거로우시겠지만 확인 후에 다시 연락드려도 괜찮을까요?"
.' -- llm answer invoked
);

-- 3
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '주문 후 배송 주소를 변경할 수 있나요?', -- query
    '5aec9b0cbb8e768576a0bc99157cbb8a,72f328e328ed93624991283a5e2e3c09,de14d9dd57ef5fcc9a3f113baea01aa7', -- hashed_docs
    "query:  주문 후 배송 주소를 변경할 수 있나요?
================================================================================
Answer : 네, 주문 후 배송 주소 변경 가능 여부는 주문 시점과 상품 상태에 따라 달라집니다.
 정확한 상담을 위해 주문하신 주문 번호 확인 부탁드립니다.
 주문 직후라면 변경이 가능하지만, 이미 상품이 출고되었거나 선물하기 상품인 경우 변경이 어려울 수 있습니다.



**각 조건별 대응 방법**

* **주문 직후 (상품 미출고):** `주문번호 확인 후 변경 가능 여부를 확인해 드리겠습니다.
 마이쿠팡 > 주문목록 > 주문상세보기에서 `받는사람 정보`의 `받는주소` 변경을 시도해 보시고, 변경이 안 되면 바로 연락 주세요.
 최대한 도와드리겠습니다.
`

* **상품 출고 후:** `죄송합니다만, 상품이 이미 출고되어 배송지 변경이 불가능합니다.
 불편을 드려 죄송합니다.
`

* **선물하기 상품:** `죄송합니다만, 선물하기 상품은 배송지 변경이 불가능합니다.
 수취인이 배송지를 변경할 수도 없으므로, 쿠팡 고객센터(1577-7011)로 연락하셔서 취소 및 반품을 접수하시는 것이 좋겠습니다.
`
." -- llm answer invoked
);

-- 4
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '주문 후 결제 방법을 변경할 수 있나요?', -- query
    '5aec9b0cbb8e768576a0bc99157cbb8a,bde0c651280c5ac895b3f13672e581bd,e4d477a414f3783aa6b9a762d34bf195', -- hashed_docs
    'Answer : 네, 안녕하세요
 쿠팡 고객센터입니다
 주문 후 결제 방법 변경에 대해 문의하셨네요
 죄송하지만, 현재 시스템 상 주문 완료 후 결제 방법 변경은 불가능합니다
 주문 취소 후 다시 원하는 결제 방법으로 주문해주셔야 합니다
 정확한 상담을 위해 주문하신 주문 번호 확인 부탁드립니다



**각 조건별 대응 방법**

* **주문 배송 전:** 주문 번호 확인 후, 주문 취소 절차를 안내하고, 취소 완료 후 재주문을 유도한다
 마이쿠팡 > 주문목록 > 상품선택 > [주문취소] 버튼을 누르고 안내에 따라 진행하면 된다고 설명한다

* **주문 배송 중 또는 배송 완료:** 배송 중이거나 완료된 경우, 주문 취소가 불가능하므로, 배송 완료 후 반품 접수를 안내한다
 단, 단순 변심 반품 시 왕복 배송비가 발생할 수 있다는 점을 명확히 고지한다
 반품 절차에 대한 자세한 안내를 제공한다

* **결제 수단이 무통장 입금인 경우:** 다른 은행으로 변경 불가능하며, 주문 취소 후 재주문을 안내한다

* **신용카드 결제 후 할부 개월 수 변경 요청:** 쿠팡에서는 할부 개월 수 변경이 불가능하며, 주문 취소 후 재주문을 안내한다
 다만, 카드사별로 변경 가능성이 있으므로 해당 카드사에 직접 문의할 것을 권장한다
' -- llm answer invoked
);

-- 5
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '배송 중 상품이 파손되었어요. (판매자 귀책사유)', -- query
    '30a11b658c324cf1a36b053b2730b6be,3d8fa224f0094ee05929de55658d9888,48cf0cbf4deb86419f800a1834f01cda', -- hashed_docs
    'Answer : 네, 배송 중 상품이 파손되셨다니 정말 죄송합니다
 빠르게 처리해드릴 수 있도록 최선을 다하겠습니다
 정확한 상담을 위해 주문하신 주문 번호 확인 부탁드립니다



**각 조건별 대응 방법**

* **판매자 귀책 사유 (상품 파손):** 고객님께서 상품을 수령하신 날부터 3개월 이내, 또는 파손 사실을 알거나 알 수 있었던 날부터 30일 이내에 교환/반품이 가능합니다
 마이쿠팡 > 주문목록 > 상품선택 > [교환/반품 신청]을 통해 직접 신청하실 수 있으며, 신청이 어려우시면 고객센터로 연락 주시면 친절하게 안내해 드리겠습니다
 판매자 귀책이므로 반품 비용은 고객님께서 부담하지 않으셔도 됩니다
 사진이나 영상 증거자료를 함께 제출해주시면 처리가 더욱 원활하게 진행됩니다' -- llm answer invoked
);

-- 6
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '배송 날짜를 지정할 수 있나요?', -- query
    '11043295072c53694791e1f8a148e1cc,bdeaa7f6b42ff46bd0759e68ac83a0f4,e1780ea671088fe48ca8143c05970873', -- hashed_docs
    'Answer : 네, 고객님
 배송 날짜 지정에 대해 안내해 드리겠습니다
 일반 상품의 경우 배송 날짜와 시간을 지정할 수 없지만, 로켓배송 상품은 주문/결제 시 배송 날짜를 지정할 수 있습니다
 정확한 안내를 위해 주문하신 주문 번호 확인 부탁드립니다



**각 조건별 대응 방법**

* **로켓배송 상품인 경우:** `고객님께서 주문하신 상품이 로켓배송 상품이라면 주문 시 배송 날짜를 지정하실 수 있습니다
 주문번호를 확인하여 지정 가능 여부를 다시 한번 확인해 드리겠습니다
` (주문번호 확인 후, 실제로 지정 가능한지 확인하고 안내)

* **로켓배송 상품이 아닌 경우:** `죄송합니다만, 고객님께서 주문하신 상품은 로켓배송 상품이 아니므로 배송 날짜와 시간을 지정하실 수 없습니다
 다만, 상품 상세페이지에 배송 예정일이 안내되어 있으니 참고 부탁드립니다
`

* **주문번호 확인 불가능한 경우:** `문의주신 내용은 확인이 필요하여 지금 답변드리기 어려울 것 같습니다
 번거로우시겠지만 확인 후에 다시 연락드려도 괜찮을까요?`' -- llm answer invoked
);

-- 7
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '배송 주소를 잘못 입력했어요. 어떻게 수정하나요?', -- query
    '5aec9b0cbb8e768576a0bc99157cbb8a,cc8814d9cda4d08f15c7ef846edb4e22,edeaf4fff971a90bdcd164ec09b7c7ad', -- hashed_docs
    'Answer : 네, 배송 주소 오류로 불편을 드린 점 진심으로 사과드립니다
 정확한 상담을 위해 주문하신 주문 번호 확인 부탁드립니다
 주문 단계에서 잘못 입력하셨다면 주문/결제 페이지에서 배송지를 수정하실 수 있으며, 이미 주문이 완료된 경우라면 마이쿠팡의 주소록(배송지) 관리에서 수정 후 기본 배송지로 설정하시면 됩니다



**각 조건별 대응 방법**

* **주문 전:** 주문 페이지에서 직접 배송지를 수정하도록 안내한다
 수정 방법을 자세히 설명하고, 필요시 화면 캡쳐 등을 활용하여 안내한다


* **주문 후, 배송 전:** 마이쿠팡 > 주소록(배송지) 관리에서 배송지를 수정하도록 안내한다
 수정 방법을 자세히 설명하고, 기본 배송지로 설정하는 방법을 추가로 안내한다
 만약 선물하기 주문인 경우, 배송지 변경이 불가능하다는 점을 알리고 쿠팡 고객센터(1577-7011)로 연락하여 취소 및 반품을 안내한다


* **배송 시작 후:** 배송 시작 후에는 배송지 변경이 어려울 수 있다는 점을 설명하고, 쿠팡 고객센터(1577-7011)에 문의하여 해결 방안을 찾도록 안내한다
 고객센터 연결을 돕고, 필요시 고객센터 상담 내용을 메모하여 추후 확인을 위한 자료로 활용한다' -- llm answer invoked
);

-- 8
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '반품할 수 있는 기간은 언제까지인가요?', -- query
    '3d8fa224f0094ee05929de55658d9888,7d013fa937f10187196ea1038e825246,8125a5bae6ca6c062b3b1a676f9a652f', -- hashed_docs
    'Answer : 네, 안녕하세요
 고객님의 소중한 시간을 낭비하지 않도록 최대한 신속하고 정확하게 안내해 드리겠습니다
 반품 가능 기간은 상품 종류에 따라 다르기 때문에, 정확한 안내를 위해 주문하신 주문 번호를 확인해주시면 감사하겠습니다
 주문번호 확인 후, 고객님께 맞는 반품 기간과 절차를 자세히 안내해 드리고, 필요한 경우 반품 절차를 직접 도와드리겠습니다



**각 조건별 대응 방법**

1
 **주문번호 확인 후 상품 종류 확인:** 고객님께서 주문하신 상품이 로켓배송, 로켓프레시, 로켓직구, 로켓모바일, 판매자 배송 상품, 티켓 상품 중 어떤 종류인지 확인합니다


2
 **상품 종류에 따른 안내:**
  * **로켓배송:** `고객님께서 주문하신 로켓배송 상품은 배송 완료 후 30일 이내에 반품이 가능합니다
`
  * **로켓프레시:** `고객님께서 주문하신 로켓프레시 상품은 단순 변심으로 인한 반품은 불가능합니다
 다만, 상품의 파손이나 불량 등의 문제가 있다면, 3개월 이내 또는 그 사실을 알거나 알 수 있었던 날부터 30일 이내에 반품이 가능합니다
`
  * **로켓직구:** `고객님께서 주문하신 로켓직구 상품은 배송 완료 후 7일 이내에 반품이 가능합니다
`
  * **로켓모바일:** `고객님께서 주문하신 로켓모바일 상품은 주문일 포함 14일 이내에 반품이 가능합니다
...
 **반품 절차 지원:** 고객님이 반품을 원하시면, 반품 신청 방법 (`마이쿠팡 → 주문목록 → 상품선택 → [교환 반품신청]`)을 안내하고, 필요한 경우 신청 과정을 함께 진행하며 도움을 드립니다
 파손/불량/오배송 등의 경우에는 증빙자료 확보를 안내하고, 필요시 사진이나 영상 첨부를 요청합니다
' -- llm answer invoked
);

-- 9
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '반품 시 배송비는 누가 부담하나요?', -- query
    '2409d3e8362240cdad39396d0b883188,30b37f1c049c11ba8cb4637e50aedeca,48cf0cbf4deb86419f800a1834f01cda', -- hashed_docs
    'query:  반품 시 배송비는 누가 부담하나요?
================================================================================
Answer : 네, 안녕하세요
 반품 시 배송비에 대한 문의 주셨네요
 정확한 안내를 위해 주문하신 주문 번호 확인 부탁드립니다
 상품의 불량이나 오배송 등 판매자의 책임이 있는 경우에는 배송비를 부담하지 않으시지만, 단순 변심인 경우에는 고객님께서 배송비를 부담하실 수 있습니다



**각 조건별 대응 방법**

* **판매자 귀책 사유 (상품 불량, 파손, 오배송):** `고객님께 불편을 드린 점 진심으로 사과드립니다
 판매자 귀책 사유로 인한 반품이므로 배송비는 저희가 부담합니다
 반품 접수 후 안내해 드리는 절차에 따라 진행해주시면 됩니다
`

* **구매자 단순 변심:** `단순 변심으로 인한 반품의 경우, 배송비는 고객님께서 부담하시게 됩니다
 자세한 반품 비용은 [context]에 안내된 링크를 참고해주시거나, 주문번호 확인 후 정확한 금액을 안내해 드리겠습니다
`

* **부재중 반송:** `고객님의 부재로 인해 상품이 반송된 경우, 재배송 비용은 고객님께서 부담하셔야 합니다
 다시 배송을 원하시면 재배송 신청을 도와드리겠습니다
`' -- llm answer invoked
);

-- 10
INSERT INTO cache (created_at, query, hashed_docs, created_answer)
VALUES (
    now(), -- created_at
    '교환된 상품이 마음에 들지 않으면 어떻게 하나요?', -- query
    '9e08ee6d1e8333375ef21a8eb98206fd,b5ace08316bde547ddba86e77ebbe897,d1f369d3e35f14c96275cf42d809c6f1', -- hashed_docs
    'query:  교환된 상품이 마음에 들지 않으면 어떻게 하나요?
================================================================================
Answer : 네, 교환하신 상품이 마음에 들지 않으시다니 정말 죄송합니다
 정확한 상담을 위해 주문하신 주문 번호 확인 부탁드립니다
 고객님께서 교환하신 상품의 종류와 상황을 확인하여 최대한 빠르게 도와드리겠습니다



**조건별 대응 방법**

* **교환 상품이 단순 변심인 경우:** 고객님께서 교환하신 상품이 마음에 들지 않으시는 경우, 기존 안내대로 동일 상품으로의 교환은 어렵습니다
 색상이나 사이즈 변경을 원하시면, 번거로우시겠지만 해당 상품을 반품하신 후 재구매를 해주셔야 합니다
 반품 절차에 대해 안내해 드리겠습니다
 마이쿠팡 접속 후 주문목록에서 교환/반품 신청을 해주시면 됩니다


* **교환 상품에 하자가 있는 경우:** 교환받으신 상품에 하자가 있다면, 사진이나 영상과 함께 마이쿠팡을 통해 교환/반품 신청을 해주세요
 상품 검수 후, 하자 여부 확인 후 교환 또는 환불 처리를 도와드리겠습니다
 만약 검수 결과 교환/반품이 불가능한 경우에는 고객님께 다시 상품을 돌려드리고, 그 이유를 자세히 설명드리겠습니다


* **기타 경우 (Context 정보 부족):** 문의주신 내용은 확인이 필요하여 지금 답변드리기 어려울 것 같습니다
 번거로우시겠지만 확인 후에 다시 연락드려도 괜찮을까요?' -- llm answer invoked
);